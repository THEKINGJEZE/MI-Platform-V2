---
description: Fetch latest Claude Code documentation, audit project configuration, and generate improvement recommendations
---

# Audit Claude Code Setup

Run a comprehensive audit of this project's Claude Code configuration against current best practices.

## Purpose

- Detect documentation drift (Claude Code docs update, our setup doesn't)
- Identify capability blindness (new features we don't know about)
- Reduce cognitive load (James shouldn't have to read docs manually)

## Execution Steps

### Step 1: Fetch Documentation

Use the `docs-fetcher` agent to retrieve current Claude Code documentation.

```
Use Task tool with subagent_type="docs-fetcher" to:
- Fetch Claude Code documentation pages
- Extract features, best practices, anti-patterns
- Note any recent changes or new capabilities
```

### Step 2: Audit Configuration

Use the `config-auditor` agent to catalog current setup.

```
Use Task tool with subagent_type="config-auditor" to:
- Scan .claude/ directory structure
- Read all CLAUDE.md files
- Catalog hooks, agents, commands, skills, rules
- Flag issues and missing configurations
```

### Step 3: Generate Recommendations

Use the `improvement-planner` agent to create actionable recommendations.

```
Use Task tool with subagent_type="improvement-planner" with:
- Documentation summary from Step 1
- Configuration audit from Step 2
Produce prioritised recommendations.
```

### Step 4: Write Report

Create the audit report at `docs/audits/YYYY-MM-DD-audit.md` using the template below.

Ensure the `docs/audits/` directory exists first.

## Report Template

```markdown
# Claude Code Setup Audit ‚Äî {date}

## Executive Summary
{2-3 sentences: health status first, then key findings}

Example if healthy:
> "Setup is healthy (9/10). All configurations valid, no security issues. Top recommendation: Add sandbox mode for safer workflow testing."

Example if issues found:
> "Setup has 2 critical issues requiring immediate attention. The `docs-fetcher` subagent references an invalid model name, and one hook script is missing. Fix these before adding new capabilities."

## Setup Health Check

### Overall Status: {‚úÖ Healthy / ‚ö†Ô∏è Issues Found / ‚ùå Critical Problems}

**Health Score**: {X}/10

### Critical Issues (Must Fix Before Anything Else)
| Issue | Location | Problem | Fix |
|-------|----------|---------|-----|
| {issue name} | {file:line} | {what's wrong} | {how to fix} |

{If none: "‚úÖ No critical issues found"}

### Warnings (Should Address)
| Warning | Location | Concern | Recommendation |
|---------|----------|---------|----------------|
| {warning name} | {file} | {potential issue} | {what to do} |

{If none: "‚úÖ No warnings"}

### Validation Summary
| Category | Passed | Failed | Warnings |
|----------|--------|--------|----------|
| CLAUDE.md | | | |
| Settings | | | |
| Hooks | | | |
| Skills | | | |
| Agents | | | |
| Commands | | | |
| Security | | | |
| Consistency | | | |
| **Total** | | | |

## Current Configuration

### CLAUDE.md
- Location: {path}
- Lines: {count}
- Key sections: {list}

### Settings
- Default model: {model}
- Permissions: {summary}
- Context auto-load: {files}

### Hooks
| Hook | Trigger | Purpose |
|------|---------|---------|
| {name} | {trigger} | {description} |

### Agents
| Agent | Model | Tools | Purpose |
|-------|-------|-------|---------|
| {name} | {model} | {tools} | {description} |

### Commands
| Command | Description |
|---------|-------------|
| {name} | {description} |

### Skills
| Skill | Path | Description |
|-------|------|-------------|
| {name} | {path} | {description} |

### Rules
| Rule | Path | Purpose |
|------|------|---------|
| {name} | {path} | {purpose} |

## Documentation Updates
{List any new features, changed patterns, or deprecations found in docs}

### New Features Available
- **{feature}**: {description}

### Changed Patterns
- **{pattern}**: {what changed}

### Deprecations/Warnings
- **{item}**: {warning}

## Recommendations

### üî¥ Critical Issues (Fix These First)
{Validation failures, broken configs, security vulnerabilities}

#### 1. {title}
- **Problem**: {what's broken}
- **Location**: {file path}
- **Fix**: {exact steps}
- **Impact if not fixed**: {what will fail}

{If none: "‚úÖ No critical issues ‚Äî proceed to high priority recommendations"}

### üü† High Priority
{Recommendations with significant impact, relatively easy to implement}

#### {N}. {title}
- **Gap**: {what's missing or suboptimal}
- **Recommendation**: {what to do}
- **Docs reference**: {url or section}
- **Effort**: {Low/Medium/High}
- **Benefit**: {description}

### üü° Medium Priority
{Same format}

### üü¢ Low Priority / Future
{Same format}

## Quick Wins
{Changes that take <5 minutes}

1. {quick change}
2. {quick change}

## Issues Found
| Severity | Issue | Location | Fix |
|----------|-------|----------|-----|
| {level} | {issue} | {where} | {how to fix} |

## Next Audit
Recommended: {date + 1 month}

---
*Generated by `/audit-claude-setup` command*
*Runtime: {duration}*
```

## Success Criteria

- [ ] Report saved to `docs/audits/YYYY-MM-DD-audit.md`
- [ ] All doc URLs attempted (failures logged)
- [ ] All .claude/ contents cataloged
- [ ] **Validation checks run for all config files**
- [ ] **Failed validations include specific fix instructions with file paths**
- [ ] **Health score calculated (0-10 based on pass/fail/warning ratio)**
- [ ] **Critical issues appear at top of report, before other recommendations**
- [ ] **Security checks included in every audit**
- [ ] **Report clearly distinguishes "broken" vs "could be better"**
- [ ] At least 3 actionable recommendations generated
- [ ] Report readable and actionable within 5 minutes

## Notes

- Run monthly or when suspecting Claude Code has new features
- Previous audits in `docs/audits/` for comparison
- Runtime target: < 3 minutes

## First-Run Note

The subagents (`docs-fetcher`, `config-auditor`, `improvement-planner`) are registered from `.claude/agents/` on session start. If you just installed this command, **restart Claude Code** or start a new session for the agents to be available.

**Fallback for immediate use**: If subagents aren't registered yet, the orchestrator can perform the same work using `claude-code-guide` agent for documentation fetching and `Explore` agent for configuration auditing, following the prompts defined in the agent files.
